!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).heremap=f()}}(function(){return function(){return function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}}()({1:[function(require,module,exports){var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,function(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],2:[function(require,module,exports){(function(process){const request=require("superagent");let APP_ID=process.env.APP_ID,APP_CODE=process.env.APP_CODE,cit="",protocol="https://";function init(obj){obj.app_id&&(APP_ID=obj.app_id),obj.app_code&&(APP_CODE=obj.app_code),obj.useCIT&&(cit=".cit"),obj.useHTTP&&(protocol="http://")}async function matrix(source,dest,opt){return new Promise((resolve,reject)=>{let tStart=new Date;var settings={app_id:APP_ID,app_code:APP_CODE,mode:"fastest;car",summaryAttributes:"tt,di"};let params=Object.assign(settings,opt);Array.isArray(source[0])||(source=[source]),source.forEach((coord,i)=>{params["start"+i]=coord[0]+","+coord[1]}),Array.isArray(dest[0])||(dest=[dest]),dest.forEach((coord,i)=>{params["destination"+i]=coord[0]+","+coord[1]}),request.post("http://matrix.route"+cit+".api.here.com/routing/7.2/calculatematrix.json").query(params).then(res=>{if(!res.body.response){let e=new Error(res.body);return e.name="Matrix error:",reject(e)}if("ApplicationError"==res.body.response.type){let e=new Error(res.body.response.details);return e.name="Matrix  error:",reject(e)}resolve({resptime:new Date-tStart,entries:res.body.response.matrixEntry,body:res.body})}).catch(err=>reject(err))})}module.exports={init:init,geocode:async function(address){let tStart=new Date;return new Promise((resolve,reject)=>{const settings={app_id:APP_ID,app_code:APP_CODE,searchText:address};request.get(protocol+"geocoder"+cit+".api.here.com/6.2/geocode.json").query(settings).then(res=>{if(!res.body.Response){let e=new Error(res.body);return e.name="Geocode Query error:",reject(e)}if(0==res.body.Response.View.length){let e=new Error(address);return e.name="Geocode Adddress not found:",reject(e)}var location=res.body.Response.View[0].Result[0].Location,coord=[location.NavigationPosition[0].Latitude,location.NavigationPosition[0].Longitude];resolve({respTime:new Date-tStart,coord:coord,body:res.body})}).catch(err=>reject(err))})},reverseGeocode:async function(coord){let tStart=new Date;return new Promise((resolve,reject)=>{const settings={app_id:APP_ID,app_code:APP_CODE,mode:"retrieveAddresses",prox:coord[0]+","+coord[1]};request.get(protocol+"reverse.geocoder"+cit+".api.here.com/6.2/reversegeocode.json").query(settings).then(res=>{if(!res.body.Response){let e=new Error(res.body);return e.name="Reverse Geocode Query error:",reject(e)}if(0==res.body.Response.View.length){let e=new Error(coord);return e.name="Reverse Geocode Query Location not found:",reject(e)}var location=res.body.Response.View[0].Result[0].Location;resolve({respTime:new Date-tStart,location:location,address:location.Address,body:res.body})}).catch(err=>reject(err))})},matrix:matrix,route:async function(source,dest,opt){let tStart=new Date;return new Promise((resolve,reject)=>{const settings={app_id:APP_ID,app_code:APP_CODE,mode:"fastest;car;traffic:disabled",representation:"linkPaging",routeattributes:"waypoints,summary,shape",maneuverattributes:"direction,action"};let params=Object.assign(settings,opt),id=0;if(Array.isArray(source[0]))for(var i=0;i<source.length;i++){let coord=source[i];params["waypoint"+id++]=coord[0]+","+coord[1]}else params["waypoint"+id++]=source[0]+","+source[1];if(Array.isArray(dest[0]))for(let i=0;i<dest.length;i++){let coord=dest[i];params["waypoint"+id++]=coord[0]+","+coord[1]}else params["waypoint"+id++]=dest[0]+","+dest[1];request.post(protocol+"route"+cit+".api.here.com/routing/7.2/calculateroute.json").query(params).then(res=>{if(!res.body.response){let e=new Error(res.body);return e.name="Routing Query error:",reject(e)}if("ApplicationError"==res.body.response.type){let e=new Error(res.body.response.details);return e.name="Routing  error:",reject(e)}const route=res.body.response.route[0],summary=route.summary;resolve({resptime:new Date-tStart,summary:summary,route:route,body:res.body})}).catch(err=>reject(err))})},isoline:async function(opt){let tStart=new Date;return new Promise((resolve,reject)=>{const settings={app_id:APP_ID,app_code:APP_CODE,start:null,destination:null,rangeType:"time",range:null,requestId:null,linkattributes:"sh",mode:"fastest;car;traffic:disabled"};let params=Object.assign(settings,opt);return params.start&&(params.start="geo!"+params.start[0]+","+params.start[1]),params.destination&&(params.destination="geo!"+params.destination[0]+","+params.destination[1]),params.start||params.destination?params.range?void request.post(protocol+"isoline.route"+cit+".api.here.com/routing/7.2/calculateisoline.json").query(params).then(res=>{if(!res.body.response){let e=new Error(res.body);return e.name="Isoline  error:",reject(e)}if("ApplicationError"==res.body.response.type){let e=new Error(res.body.response.details);return e.name="Isoline  error:",reject(e)}const poly=res.body.response.isoline[0].component[0].shape.map(point=>point.split(","));resolve({resptime:new Date-tStart,poly:poly,body:res.body})}).catch(err=>reject(err)):reject("Isoline routing : missing range"):reject("Isoline routing : missing start or destination")})},detour:async function(start,stop,waypoints){return new Promise(async(resolve,reject)=>{if(!start)return reject("missing start point");if(!stop)return reject("missing stop point");if(!waypoints)return reject("missing waypoints");if(!Array.isArray)return reject("waypoints should be an array");let res={reference:{},waypoints:[]},dest=[stop];waypoints.forEach(waypoint=>{dest.push(waypoint),res.waypoints.push({coord:waypoint})});let p1=matrix(start,dest,{mode:"fastest;car;traffic:disabled"});dest[0]=start;let p2=matrix(dest,stop,{mode:"fastest;car;traffic:disabled"});const result=await Promise.all([p1,p2]);let entries=result[0].entries,dist=entries[0].summary.distance,time=entries[0].summary.travelTime;return res.reference.start=start,res.reference.stop=stop,res.reference.distance=dist,res.reference.time=time,entries.forEach((entry,i)=>{if(0==i)return;if("failed"==entry.status)return;let id=entry.destinationIndex,dist=entry.summary.distance,time=entry.summary.travelTime;res.waypoints[id-1].distA=dist,res.waypoints[id-1].timeA=time}),entries=result[1].entries,res.reference.distance2=entries[0].summary.distance,res.reference.time2=entries[0].summary.travelTime,entries.forEach((entry,i)=>{if(0==i)return;if("failed"==entry.status)return;let id=entry.startIndex,dist=entry.summary.distance,time=entry.summary.travelTime;res.waypoints[id-1].distB=dist,res.waypoints[id-1].timeB=time}),resolve(res)})}}}).call(this,require("_process"))},{_process:1,superagent:5}],3:[function(require,module,exports){function Emitter(obj){if(obj)return function(obj){for(var key in Emitter.prototype)obj[key]=Emitter.prototype[key];return obj}(obj)}void 0!==module&&(module.exports=Emitter),Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){return this._callbacks=this._callbacks||{},(this._callbacks["$"+event]=this._callbacks["$"+event]||[]).push(fn),this},Emitter.prototype.once=function(event,fn){function on(){this.off(event,on),fn.apply(this,arguments)}return on.fn=fn,this.on(event,on),this},Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var cb,callbacks=this._callbacks["$"+event];if(!callbacks)return this;if(1==arguments.length)return delete this._callbacks["$"+event],this;for(var i=0;i<callbacks.length;i++)if((cb=callbacks[i])===fn||cb.fn===fn){callbacks.splice(i,1);break}return this},Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks["$"+event];if(callbacks)for(var i=0,len=(callbacks=callbacks.slice(0)).length;i<len;++i)callbacks[i].apply(this,args);return this},Emitter.prototype.listeners=function(event){return this._callbacks=this._callbacks||{},this._callbacks["$"+event]||[]},Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}},{}],4:[function(require,module,exports){function Agent(){this._defaults=[]}["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert"].forEach(fn=>{Agent.prototype[fn]=function(...args){return this._defaults.push({fn:fn,args:args}),this}}),Agent.prototype._setDefaults=function(req){this._defaults.forEach(def=>{req[def.fn].apply(req,def.args)})},module.exports=Agent},{}],5:[function(require,module,exports){let root;"undefined"!=typeof window?root=window:"undefined"!=typeof self?root=self:(console.warn("Using browser-only version of superagent in non-browser environment"),root=this);const Emitter=require("component-emitter"),RequestBase=require("./request-base"),isObject=require("./is-object"),ResponseBase=require("./response-base"),Agent=require("./agent-base");function noop(){}const request=exports=module.exports=function(method,url){return"function"==typeof url?new exports.Request("GET",method).end(url):1==arguments.length?new exports.Request("GET",method):new exports.Request(method,url)};exports.Request=Request,request.getXHR=(()=>{if(!(!root.XMLHttpRequest||root.location&&"file:"==root.location.protocol&&root.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}throw Error("Browser-only version of superagent could not find XHR")});const trim="".trim?s=>s.trim():s=>s.replace(/(^\s*|\s*$)/g,"");function serialize(obj){if(!isObject(obj))return obj;const pairs=[];for(const key in obj)pushEncodedKeyValuePair(pairs,key,obj[key]);return pairs.join("&")}function pushEncodedKeyValuePair(pairs,key,val){if(null!=val)if(Array.isArray(val))val.forEach(v=>{pushEncodedKeyValuePair(pairs,key,v)});else if(isObject(val))for(const subkey in val)pushEncodedKeyValuePair(pairs,`${key}[${subkey}]`,val[subkey]);else pairs.push(encodeURIComponent(key)+"="+encodeURIComponent(val));else null===val&&pairs.push(encodeURIComponent(key))}function parseString(str){const obj={},pairs=str.split("&");let pair,pos;for(let i=0,len=pairs.length;i<len;++i)-1==(pos=(pair=pairs[i]).indexOf("="))?obj[decodeURIComponent(pair)]="":obj[decodeURIComponent(pair.slice(0,pos))]=decodeURIComponent(pair.slice(pos+1));return obj}function isJSON(mime){return/[\/+]json($|[^-\w])/.test(mime)}function Response(req){this.req=req,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;let status=this.xhr.status;1223===status&&(status=204),this._setStatusProperties(status),this.header=this.headers=function(str){const lines=str.split(/\r?\n/),fields={};let index,line,field,val;for(let i=0,len=lines.length;i<len;++i)-1!==(index=(line=lines[i]).indexOf(":"))&&(field=line.slice(0,index).toLowerCase(),val=trim(line.slice(index+1)),fields[field]=val);return fields}(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),null===this.text&&req._responseType?this.body=this.xhr.response:this.body="HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function Request(method,url){const self=this;this._query=this._query||[],this.method=method,this.url=url,this.header={},this._header={},this.on("end",()=>{let new_err,err=null,res=null;try{res=new Response(self)}catch(e){return(err=new Error("Parser is unable to parse the response")).parse=!0,err.original=e,self.xhr?(err.rawResponse=void 0===self.xhr.responseType?self.xhr.responseText:self.xhr.response,err.status=self.xhr.status?self.xhr.status:null,err.statusCode=err.status):(err.rawResponse=null,err.status=null),self.callback(err)}self.emit("response",res);try{self._isResponseOK(res)||(new_err=new Error(res.statusText||"Unsuccessful HTTP response"))}catch(custom_err){new_err=custom_err}new_err?(new_err.original=err,new_err.response=res,new_err.status=res.status,self.callback(new_err,res)):self.callback(null,res)})}function del(url,data,fn){const req=request("DELETE",url);return"function"==typeof data&&(fn=data,data=null),data&&req.send(data),fn&&req.end(fn),req}request.serializeObject=serialize,request.parseString=parseString,request.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},request.serialize={"application/x-www-form-urlencoded":serialize,"application/json":JSON.stringify},request.parse={"application/x-www-form-urlencoded":parseString,"application/json":JSON.parse},ResponseBase(Response.prototype),Response.prototype._parseBody=function(str){let parse=request.parse[this.type];return this.req._parser?this.req._parser(this,str):(!parse&&isJSON(this.type)&&(parse=request.parse["application/json"]),parse&&str&&(str.length||str instanceof Object)?parse(str):null)},Response.prototype.toError=function(){const req=this.req,method=req.method,url=req.url,msg=`cannot ${method} ${url} (${this.status})`,err=new Error(msg);return err.status=this.status,err.method=method,err.url=url,err},request.Response=Response,Emitter(Request.prototype),RequestBase(Request.prototype),Request.prototype.type=function(type){return this.set("Content-Type",request.types[type]||type),this},Request.prototype.accept=function(type){return this.set("Accept",request.types[type]||type),this},Request.prototype.auth=function(user,pass,options){1===arguments.length&&(pass=""),"object"==typeof pass&&null!==pass&&(options=pass,pass=""),options||(options={type:"function"==typeof btoa?"basic":"auto"});return this._auth(user,pass,options,string=>{if("function"==typeof btoa)return btoa(string);throw new Error("Cannot use basic auth, btoa is not a function")})},Request.prototype.query=function(val){return"string"!=typeof val&&(val=serialize(val)),val&&this._query.push(val),this},Request.prototype.attach=function(field,file,options){if(file){if(this._data)throw Error("superagent can't mix .send() and .attach()");this._getFormData().append(field,file,options||file.name)}return this},Request.prototype._getFormData=function(){return this._formData||(this._formData=new root.FormData),this._formData},Request.prototype.callback=function(err,res){if(this._shouldRetry(err,res))return this._retry();const fn=this._callback;this.clearTimeout(),err&&(this._maxRetries&&(err.retries=this._retries-1),this.emit("error",err)),fn(err,res)},Request.prototype.crossDomainError=function(){const err=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");err.crossDomain=!0,err.status=this.status,err.method=this.method,err.url=this.url,this.callback(err)},Request.prototype.buffer=Request.prototype.ca=Request.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},Request.prototype.pipe=Request.prototype.write=(()=>{throw Error("Streaming is not supported in browser version of superagent")}),Request.prototype._isHost=function(obj){return obj&&"object"==typeof obj&&!Array.isArray(obj)&&"[object Object]"!==Object.prototype.toString.call(obj)},Request.prototype.end=function(fn){this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=fn||noop,this._finalizeQueryString(),this._end()},Request.prototype._end=function(){if(this._aborted)return this.callback(Error("The request has been aborted even before .end() was called"));const self=this,xhr=this.xhr=request.getXHR();let data=this._formData||this._data;this._setTimeouts(),xhr.onreadystatechange=(()=>{const readyState=xhr.readyState;if(readyState>=2&&self._responseTimeoutTimer&&clearTimeout(self._responseTimeoutTimer),4!=readyState)return;let status;try{status=xhr.status}catch(e){status=0}if(!status){if(self.timedout||self._aborted)return;return self.crossDomainError()}self.emit("end")});const handleProgress=(direction,e)=>{e.total>0&&(e.percent=e.loaded/e.total*100),e.direction=direction,self.emit("progress",e)};if(this.hasListeners("progress"))try{xhr.onprogress=handleProgress.bind(null,"download"),xhr.upload&&(xhr.upload.onprogress=handleProgress.bind(null,"upload"))}catch(e){}try{this.username&&this.password?xhr.open(this.method,this.url,!0,this.username,this.password):xhr.open(this.method,this.url,!0)}catch(err){return this.callback(err)}if(this._withCredentials&&(xhr.withCredentials=!0),!this._formData&&"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof data&&!this._isHost(data)){const contentType=this._header["content-type"];let serialize=this._serializer||request.serialize[contentType?contentType.split(";")[0]:""];!serialize&&isJSON(contentType)&&(serialize=request.serialize["application/json"]),serialize&&(data=serialize(data))}for(const field in this.header)null!=this.header[field]&&this.header.hasOwnProperty(field)&&xhr.setRequestHeader(field,this.header[field]);this._responseType&&(xhr.responseType=this._responseType),this.emit("request",this),xhr.send(void 0!==data?data:null)},request.agent=(()=>new Agent),["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach(method=>{Agent.prototype[method.toLowerCase()]=function(url,fn){const req=new request.Request(method,url);return this._setDefaults(req),fn&&req.end(fn),req}}),Agent.prototype.del=Agent.prototype.delete,request.get=((url,data,fn)=>{const req=request("GET",url);return"function"==typeof data&&(fn=data,data=null),data&&req.query(data),fn&&req.end(fn),req}),request.head=((url,data,fn)=>{const req=request("HEAD",url);return"function"==typeof data&&(fn=data,data=null),data&&req.query(data),fn&&req.end(fn),req}),request.options=((url,data,fn)=>{const req=request("OPTIONS",url);return"function"==typeof data&&(fn=data,data=null),data&&req.send(data),fn&&req.end(fn),req}),request.del=del,request.delete=del,request.patch=((url,data,fn)=>{const req=request("PATCH",url);return"function"==typeof data&&(fn=data,data=null),data&&req.send(data),fn&&req.end(fn),req}),request.post=((url,data,fn)=>{const req=request("POST",url);return"function"==typeof data&&(fn=data,data=null),data&&req.send(data),fn&&req.end(fn),req}),request.put=((url,data,fn)=>{const req=request("PUT",url);return"function"==typeof data&&(fn=data,data=null),data&&req.send(data),fn&&req.end(fn),req})},{"./agent-base":4,"./is-object":6,"./request-base":7,"./response-base":8,"component-emitter":3}],6:[function(require,module,exports){"use strict";module.exports=function(obj){return null!==obj&&"object"==typeof obj}},{}],7:[function(require,module,exports){"use strict";const isObject=require("./is-object");function RequestBase(obj){if(obj)return function(obj){for(const key in RequestBase.prototype)obj[key]=RequestBase.prototype[key];return obj}(obj)}module.exports=RequestBase,RequestBase.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,this},RequestBase.prototype.parse=function(fn){return this._parser=fn,this},RequestBase.prototype.responseType=function(val){return this._responseType=val,this},RequestBase.prototype.serialize=function(fn){return this._serializer=fn,this},RequestBase.prototype.timeout=function(options){if(!options||"object"!=typeof options)return this._timeout=options,this._responseTimeout=0,this;for(const option in options)switch(option){case"deadline":this._timeout=options.deadline;break;case"response":this._responseTimeout=options.response;break;default:console.warn("Unknown timeout option",option)}return this},RequestBase.prototype.retry=function(count,fn){return 0!==arguments.length&&!0!==count||(count=1),count<=0&&(count=0),this._maxRetries=count,this._retries=0,this._retryCallback=fn,this};const ERROR_CODES=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];RequestBase.prototype._shouldRetry=function(err,res){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{const override=this._retryCallback(err,res);if(!0===override)return!0;if(!1===override)return!1}catch(e){console.error(e)}if(res&&res.status&&res.status>=500&&501!=res.status)return!0;if(err){if(err.code&&~ERROR_CODES.indexOf(err.code))return!0;if(err.timeout&&"ECONNABORTED"==err.code)return!0;if(err.crossDomain)return!0}return!1},RequestBase.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this._end()},RequestBase.prototype.then=function(resolve,reject){if(!this._fullfilledPromise){const self=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise((innerResolve,innerReject)=>{self.on("error",innerReject),self.end((err,res)=>{err?innerReject(err):innerResolve(res)})})}return this._fullfilledPromise.then(resolve,reject)},RequestBase.prototype.catch=function(cb){return this.then(void 0,cb)},RequestBase.prototype.use=function(fn){return fn(this),this},RequestBase.prototype.ok=function(cb){if("function"!=typeof cb)throw Error("Callback required");return this._okCallback=cb,this},RequestBase.prototype._isResponseOK=function(res){return!!res&&(this._okCallback?this._okCallback(res):res.status>=200&&res.status<300)},RequestBase.prototype.get=function(field){return this._header[field.toLowerCase()]},RequestBase.prototype.getHeader=RequestBase.prototype.get,RequestBase.prototype.set=function(field,val){if(isObject(field)){for(const key in field)this.set(key,field[key]);return this}return this._header[field.toLowerCase()]=val,this.header[field]=val,this},RequestBase.prototype.unset=function(field){return delete this._header[field.toLowerCase()],delete this.header[field],this},RequestBase.prototype.field=function(name,val){if(null===name||void 0===name)throw new Error(".field(name, val) name can not be empty");if(this._data)throw new Error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()");if(isObject(name)){for(const key in name)this.field(key,name[key]);return this}if(Array.isArray(val)){for(const i in val)this.field(name,val[i]);return this}if(null===val||void 0===val)throw new Error(".field(name, val) val can not be empty");return"boolean"==typeof val&&(val=""+val),this._getFormData().append(name,val),this},RequestBase.prototype.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this)},RequestBase.prototype._auth=function(user,pass,options,base64Encoder){switch(options.type){case"basic":this.set("Authorization",`Basic ${base64Encoder(`${user}:${pass}`)}`);break;case"auto":this.username=user,this.password=pass;break;case"bearer":this.set("Authorization",`Bearer ${user}`)}return this},RequestBase.prototype.withCredentials=function(on){return void 0==on&&(on=!0),this._withCredentials=on,this},RequestBase.prototype.redirects=function(n){return this._maxRedirects=n,this},RequestBase.prototype.maxResponseSize=function(n){if("number"!=typeof n)throw TypeError("Invalid argument");return this._maxResponseSize=n,this},RequestBase.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},RequestBase.prototype.send=function(data){const isObj=isObject(data);let type=this._header["content-type"];if(this._formData)throw new Error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()");if(isObj&&!this._data)Array.isArray(data)?this._data=[]:this._isHost(data)||(this._data={});else if(data&&this._data&&this._isHost(this._data))throw Error("Can't merge these send calls");if(isObj&&isObject(this._data))for(const key in data)this._data[key]=data[key];else"string"==typeof data?(type||this.type("form"),type=this._header["content-type"],this._data="application/x-www-form-urlencoded"==type?this._data?`${this._data}&${data}`:data:(this._data||"")+data):this._data=data;return!isObj||this._isHost(data)?this:(type||this.type("json"),this)},RequestBase.prototype.sortQuery=function(sort){return this._sort=void 0===sort||sort,this},RequestBase.prototype._finalizeQueryString=function(){const query=this._query.join("&");if(query&&(this.url+=(this.url.indexOf("?")>=0?"&":"?")+query),this._query.length=0,this._sort){const index=this.url.indexOf("?");if(index>=0){const queryArr=this.url.substring(index+1).split("&");"function"==typeof this._sort?queryArr.sort(this._sort):queryArr.sort(),this.url=this.url.substring(0,index)+"?"+queryArr.join("&")}}},RequestBase.prototype._appendQueryString=(()=>{console.trace("Unsupported")}),RequestBase.prototype._timeoutError=function(reason,timeout,errno){if(this._aborted)return;const err=new Error(`${reason+timeout}ms exceeded`);err.timeout=timeout,err.code="ECONNABORTED",err.errno=errno,this.timedout=!0,this.abort(),this.callback(err)},RequestBase.prototype._setTimeouts=function(){const self=this;this._timeout&&!this._timer&&(this._timer=setTimeout(()=>{self._timeoutError("Timeout of ",self._timeout,"ETIME")},this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout(()=>{self._timeoutError("Response timeout of ",self._responseTimeout,"ETIMEDOUT")},this._responseTimeout))}},{"./is-object":6}],8:[function(require,module,exports){"use strict";const utils=require("./utils");function ResponseBase(obj){if(obj)return function(obj){for(const key in ResponseBase.prototype)obj[key]=ResponseBase.prototype[key];return obj}(obj)}module.exports=ResponseBase,ResponseBase.prototype.get=function(field){return this.header[field.toLowerCase()]},ResponseBase.prototype._setHeaderProperties=function(header){const ct=header["content-type"]||"";this.type=utils.type(ct);const params=utils.params(ct);for(const key in params)this[key]=params[key];this.links={};try{header.link&&(this.links=utils.parseLinks(header.link))}catch(err){}},ResponseBase.prototype._setStatusProperties=function(status){const type=status/100|0;this.status=this.statusCode=status,this.statusType=type,this.info=1==type,this.ok=2==type,this.redirect=3==type,this.clientError=4==type,this.serverError=5==type,this.error=(4==type||5==type)&&this.toError(),this.created=201==status,this.accepted=202==status,this.noContent=204==status,this.badRequest=400==status,this.unauthorized=401==status,this.notAcceptable=406==status,this.forbidden=403==status,this.notFound=404==status,this.unprocessableEntity=422==status}},{"./utils":9}],9:[function(require,module,exports){"use strict";exports.type=(str=>str.split(/ *; */).shift()),exports.params=(str=>str.split(/ *; */).reduce((obj,str)=>{const parts=str.split(/ *= */),key=parts.shift(),val=parts.shift();return key&&val&&(obj[key]=val),obj},{})),exports.parseLinks=(str=>str.split(/ *, */).reduce((obj,str)=>{const parts=str.split(/ *; */),url=parts[0].slice(1,-1);return obj[parts[1].split(/ *= */)[1].slice(1,-1)]=url,obj},{})),exports.cleanHeader=((header,changesOrigin)=>(delete header["content-type"],delete header["content-length"],delete header["transfer-encoding"],delete header.host,changesOrigin&&(delete header.authorization,delete header.cookie),header))},{}]},{},[2])(2)});